# Add labels when PR opened.
name: PR_Labeler

on: pull_request

jobs:
  build:
    runs-on: ubuntu-latest
    if: github.event.action == 'opened'
    env:
      PR_NUMBER: "${{ github.event.pull_request.number }}"
      BRANCH_NAME: "${{ github.base_ref }}"
      GH_TOKEN: ${{ github.token }}
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0 # これが無いと正しくタグの存在を判定できない模様

      - name: Label PRs
        run: |
          l1=$(echo "${{ env.BRANCH_NAME }}" | sed "s/\/.*//")
          l2=$(echo "${{ env.BRANCH_NAME }}" | sed "s/=.*\//=/")
          echo $l1
          echo $l2
          gh pr edit "$PR_NUMBER" --add-label $l1
          gh pr edit "$PR_NUMBER" --add-label $l2

